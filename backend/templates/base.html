<!doctype html>
<title>{% block title %}{% endblock %} Game Recommendation System</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Kanit&family=Montserrat&family=Open+Sans:wght@500&display=swap"
    rel="stylesheet">
<meta charset="UTF-8">

<body>
    <div class="full-body-container">
        <div class="top-text">
            <div class="google-colors">
                <h1 id="emoji-left">&#128126</h1>
                <h1 id="google-c">GAMERECS</h1>
                <h1 id="emoji-right">&#128126</h1>
            </div>
            <div class="header">
                <h4 id="info">Trying to find a new game to play? Look no further! Enter in the information below to find your next favorite game!</h4>
            </div>
            <div id="inputs">
                <div class="input-box">
                    <img src="{{ url_for('static', filename='images/mag.png') }}" />
                    <input placeholder="Input a game that you like" id="filter-title">
                </div>
                <div class="genre-box">
                    <select class="genre-dropdown" name="genres" id="genres" onChange="filterText()">
                        <option value="" disabled selected hidden>Select a genre of interest</option>
                        <option value="Adventure">Adventure</option>
                        <option value="Brawler">Brawler</option>
                        <option value="Platform">Platform</option>
                        <option value="RPG">RPG</option>
                    </select>
                </div>
                <div class="ratings-box" onclick="sendFocus()">
                    <img src="{{ url_for('static', filename='images/mag.png') }}" />
                    <input placeholder="Minimum rating" id="filter-rating" onkeyup="filterText()">
                </div>
                <div class="popularity-box" onclick="sendFocus()">
                    <img src="{{ url_for('static', filename='images/mag.png') }}" />
                    <input placeholder="Minimum players" id="filter-popularity" onkeyup="filterText()">
                </div>
                <button id="search" class="search-button" type="button" onclick="filterText()">Search</button>
            </div>
        </div>
        <div id="answer-box">

        </div>
    </div>

    <script>

        function answerBoxTemplate(title) {
            return `<div class=''>
                <h3 class='game-title'>${title}</h3>
            </div>`
        }

        function enterEvent() {
            document.getElementById("filter-title").addEventListener("keydown", function(event) {
                event.preventDefault();
                if (event.keyCode === 13) {
                    document.getElementById("search").click();
                }
            });
        }

        function filterText() {
            document.getElementById("answer-box").innerHTML = ""
            console.log(document.getElementById("filter-title").value)
            fetch("/games?" + new URLSearchParams({ game_title: document.getElementById("filter-title").value }).toString())
                .then((response) => response.json())
                .then((data) => 
                    {if (data !== "Game not found") {
                        for (let i = 0; i < 10; i++) {
                            let tempDiv = document.createElement("div")
                            tempDiv.innerHTML = answerBoxTemplate(data[i])
                            document.getElementById("answer-box").appendChild(tempDiv)
                        }
                    }
                   })

                }

    </script>
</body>